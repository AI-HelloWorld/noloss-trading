# 市场价格显示修复说明

## 问题描述
市场行情页面显示所有价格都为 $0.00，无法正常显示交易对价格。

## 问题根因
1. **.env文件配置了AsterDEX API密钥**
   - 系统自动切换到真实API模式
   - 真实API返回的数据格式不匹配，导致价格为0

2. **Symbol格式转换问题**
   - Mock数据使用 `BTC/USDT` 格式（有斜杠）
   - `get_supported_symbols()` 返回的也是 `BTC/USDT` 格式
   - 但 `_format_symbol_for_mock()` 方法未正确处理已有斜杠的情况

## 解决方案

### 1. 暂时禁用真实API，使用Mock模式
修改 `.env` 文件，注释掉AsterDEX API密钥：
```bash
# ASTER_DEX_API_KEY=...
# ASTER_DEX_API_SECRET=...
```

### 2. 修复Symbol格式转换逻辑
修改 `backend/exchanges/aster_dex.py` 中的 `_format_symbol_for_mock()` 方法：

```python
def _format_symbol_for_mock(self, symbol: str) -> str:
    """将symbol格式从BTCUSDT转换为BTC/USDT以匹配mock数据"""
    # 如果已经有斜杠，不需要转换
    if "/" in symbol:
        return symbol
    # 移除USDT后缀，添加斜杠
    if symbol.endswith("USDT"):
        base = symbol[:-4]  # 移除USDT
        return f"{base}/USDT"
    return symbol
```

## 验证结果

修复后，市场数据API正常返回价格：
```
✅ ETH/USDT: 价格=$2893.35, 24h涨跌=3.33%
✅ BTC/USDT: 价格=$52041.20, 24h涨跌=15.65%
✅ SOL/USDT: 价格=$120.45, 24h涨跌=-2.15%
```

## 访问地址

- 🌐 **前端仪表盘**：http://localhost:3000
- 🔧 **后端 API**：http://localhost:8001
- 📊 **市场行情页面**：http://localhost:3000 -> 点击顶部"市场行情"

## 注意事项

1. **如需使用真实API**：
   - 取消注释 `.env` 中的API密钥
   - 确保API密钥有效
   - 检查API返回的数据格式是否正确

2. **Mock模式的优势**：
   - 无需真实API密钥
   - 数据稳定可靠
   - 适合开发和测试
   - 可以模拟各种市场情况

3. **备份文件**：
   - `.env.backup` - 原始.env文件的备份

## 日期
2025-10-23

