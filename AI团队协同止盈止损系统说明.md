# AIå›¢é˜ŸååŒæ­¢ç›ˆæ­¢æŸå†³ç­–ç³»ç»Ÿ

## ğŸ¯ ç³»ç»Ÿæ¦‚è¿°

å°†æ­¢ç›ˆæ­¢æŸçš„å†³ç­–æƒäº¤ç»™AIå›¢é˜Ÿçš„æ‰€æœ‰æˆå‘˜è¿›è¡Œåˆ¤æ–­ï¼Œæœ€ç»ˆç”±æŠ•èµ„ç»„åˆç»ç†ç»¼åˆæ‰€æœ‰æ„è§åšå‡ºå†³ç­–ã€‚è¿™æ˜¯ä¸€ä¸ªçœŸæ­£çš„å¤šæ™ºèƒ½ä½“ååŒå†³ç­–ç³»ç»Ÿï¼Œç¡®ä¿æ­¢ç›ˆæ­¢æŸæ“ä½œå¾—åˆ°å…¨é¢ã€å¤šè§’åº¦çš„è¯„ä¼°ã€‚

## ğŸ¤– å‚ä¸å†³ç­–çš„AIå›¢é˜Ÿæˆå‘˜

### 1. æŠ€æœ¯åˆ†æå¸ˆï¼ˆDeepSeek + åƒé—®3ï¼‰
**å…³æ³¨ç‚¹**ï¼šä»·æ ¼è¶‹åŠ¿ã€æŠ€æœ¯æŒ‡æ ‡ã€æ”¯æ’‘é˜»åŠ›ä½
- **æ­¢æŸåˆ¤æ–­**ï¼šæ£€æµ‹è¶‹åŠ¿åè½¬ä¿¡å·
- **æ­¢ç›ˆåˆ¤æ–­**ï¼šè¯†åˆ«ä»·æ ¼ç›®æ ‡ä½å’Œè¶…ä¹°è¶…å–
- **ç‰¹æ®Šå»ºè®®**ï¼šç›ˆåˆ©åå»ºè®®æ”¶ç´§æ­¢æŸä¿æŠ¤åˆ©æ¶¦

**ç¤ºä¾‹åˆ¤æ–­**ï¼š
```
å¦‚æœæŒä»“ç›ˆåˆ©>3%ä¸”æŠ€æœ¯åˆ†æå»ºè®®holdï¼š
  â†’ å»ºè®®TIGHTEN_STOPï¼ˆæ”¶ç´§æ­¢æŸåˆ°æœ€é«˜ä»·ä¸‹æ–¹2%ï¼‰
  â†’ ç†ç”±ï¼šæŠ€æœ¯é¢å»ºè®®æ”¶ç´§æ­¢æŸä¿æŠ¤åˆ©æ¶¦
```

### 2. é£é™©ç®¡ç†ç»ç†ï¼ˆDeepSeekï¼‰
**å…³æ³¨ç‚¹**ï¼šé£é™©æ§åˆ¶ã€èµ„é‡‘ç®¡ç†ã€æ­¢æŸçºªå¾‹
- **å…·æœ‰å¦å†³æƒ**ï¼šé£é™©è¯„åˆ†>0.7æ—¶å¯å¼ºåˆ¶æ­¢æŸ
- **æ­¢æŸåˆ¤æ–­**ï¼šäºæŸ>2%æ—¶å»ºè®®æ­¢æŸ
- **æ­¢ç›ˆåˆ¤æ–­**ï¼šç›ˆåˆ©>5%æ—¶å»ºè®®å¯ç”¨ç§»åŠ¨æ­¢æŸ

**ç¤ºä¾‹åˆ¤æ–­**ï¼š
```
å¦‚æœé£é™©è¯„åˆ†>0.7ä¸”äºæŸ>2%ï¼š
  â†’ å¼ºåˆ¶å»ºè®®STOP_LOSS
  â†’ ç´§æ€¥åº¦ï¼š0.9ï¼ˆæœ€é«˜çº§åˆ«ï¼‰
  â†’ ç†ç”±ï¼šé£é™©è¿‡é«˜ï¼Œå¿…é¡»æ­¢æŸ

å¦‚æœç›ˆåˆ©>5%ï¼š
  â†’ å»ºè®®TRAILING_STOPï¼ˆç§»åŠ¨æ­¢æŸï¼‰
  â†’ ç†ç”±ï¼šé”å®šåˆ©æ¶¦ï¼Œé˜²æ­¢å›æ’¤
```

### 3. åŸºæœ¬é¢åˆ†æå¸ˆï¼ˆDeepSeekï¼‰
**å…³æ³¨ç‚¹**ï¼šé•¿æœŸä»·å€¼ã€åŸºæœ¬é¢å˜åŒ–
- **æ­¢æŸåˆ¤æ–­**ï¼šåŸºæœ¬é¢æ¶åŒ–æ—¶å»ºè®®ç¦»åœº
- **æ­¢ç›ˆåˆ¤æ–­**ï¼šç›ˆåˆ©>10%è¾¾åˆ°åŸºæœ¬é¢ç›®æ ‡

**ç¤ºä¾‹åˆ¤æ–­**ï¼š
```
å¦‚æœç›ˆåˆ©>10%ä¸”åŸºæœ¬é¢ç›®æ ‡è¾¾æˆï¼š
  â†’ å»ºè®®TAKE_PROFIT
  â†’ ç†ç”±ï¼šç›ˆåˆ©10%ï¼Œè¾¾åˆ°åŸºæœ¬é¢ç›®æ ‡ï¼Œå»ºè®®æ­¢ç›ˆ
```

### 4. æƒ…ç»ªåˆ†æå¸ˆï¼ˆDeepSeekï¼‰
**å…³æ³¨ç‚¹**ï¼šå¸‚åœºæƒ…ç»ªã€ç¾¤ä½“å¿ƒç†
- **æ­¢æŸåˆ¤æ–­**ï¼šæƒ…ç»ªæåº¦ææ…Œæ—¶è¯„ä¼°
- **æ­¢ç›ˆåˆ¤æ–­**ï¼šæƒ…ç»ªæåº¦è´ªå©ªæ—¶è­¦ç¤º

**ç¤ºä¾‹åˆ¤æ–­**ï¼š
```
å¦‚æœå¸‚åœºæƒ…ç»ªè½¬è´Ÿä¸”ç½®ä¿¡åº¦>0.7ï¼š
  â†’ å»ºè®®TAKE_PROFITï¼ˆå¦‚æœæœ‰åˆ©æ¶¦ï¼‰
  â†’ ç†ç”±ï¼šå¸‚åœºæƒ…ç»ªè½¬è´Ÿï¼Œå»ºè®®è°¨æ…
```

### 5. æ–°é—»åˆ†æå¸ˆï¼ˆDeepSeekï¼‰
**å…³æ³¨ç‚¹**ï¼šé‡å¤§æ–°é—»ã€çªå‘äº‹ä»¶
- **æ­¢æŸåˆ¤æ–­**ï¼šé‡å¤§åˆ©ç©ºæ¶ˆæ¯æ—¶
- **æ­¢ç›ˆåˆ¤æ–­**ï¼šé‡å¤§åˆ©å¥½æ¶ˆæ¯æ—¶ï¼ˆåšç©ºï¼‰

**ç¤ºä¾‹åˆ¤æ–­**ï¼š
```
å¦‚æœé‡å¤§åˆ©ç©ºæ¶ˆæ¯ä¸”ç½®ä¿¡åº¦>0.8ï¼š
  â†’ ç´§æ€¥å»ºè®®STOP_LOSS/TAKE_PROFIT
  â†’ ç´§æ€¥åº¦ï¼š0.8
  â†’ ç†ç”±ï¼šé‡å¤§åˆ©ç©ºæ¶ˆæ¯ï¼Œå¿…é¡»å¿«é€Ÿååº”
```

### 6. æŠ•èµ„ç»„åˆç»ç†ï¼ˆDeepSeekï¼‰- æœ€ç»ˆå†³ç­–è€…
**è§’è‰²**ï¼šç»¼åˆæ‰€æœ‰AIæ„è§ï¼Œåšå‡ºæœ€ç»ˆå†³ç­–
- é£é™©ç®¡ç†ç»ç†æœ‰å¦å†³æƒ
- éœ€è¦å›¢é˜Ÿå…±è¯†ï¼ˆ>50%æ”¯æŒï¼‰
- ç»“åˆå…­ç§æ­¢ç›ˆæ­¢æŸç­–ç•¥

## ğŸ“Š å…­ç§æ­¢ç›ˆæ­¢æŸæ–¹å¼

### 1. å›ºå®šæ­¢æŸæ­¢ç›ˆï¼ˆFixed Stopï¼‰
```python
åšå¤šï¼š
  æ­¢æŸï¼šä»·æ ¼ <= å›ºå®šæ­¢æŸä½
  æ­¢ç›ˆï¼šä»·æ ¼ >= å›ºå®šæ­¢ç›ˆä½

åšç©ºï¼š
  æ­¢æŸï¼šä»·æ ¼ >= å›ºå®šæ­¢æŸä½
  æ­¢ç›ˆï¼šä»·æ ¼ <= å›ºå®šæ­¢ç›ˆä½
```

### 2. æ³¢åŠ¨ç‡åŸºå‡†ï¼ˆVolatility-Basedï¼‰
```python
æ ¹æ®å¸‚åœºæ³¢åŠ¨ç‡åŠ¨æ€è°ƒæ•´æ­¢æŸå¹…åº¦ï¼š
  é«˜æ³¢åŠ¨ç‡ï¼šæ›´å®½çš„æ­¢æŸï¼ˆ1.5å€ï¼‰
  ä¸­ç­‰æ³¢åŠ¨ç‡ï¼šæ ‡å‡†æ­¢æŸï¼ˆ1.2å€ï¼‰
  ä½æ³¢åŠ¨ç‡ï¼šæ›´ç´§çš„æ­¢æŸï¼ˆ0.8å€ï¼‰
```

### 3. ç§»åŠ¨æ­¢æŸï¼ˆTrailing Stopï¼‰
```python
åšå¤šï¼š
  æ¿€æ´»æ¡ä»¶ï¼šç›ˆåˆ© >= 3%
  ç§»åŠ¨è§„åˆ™ï¼šä»æœ€é«˜ä»·å›æ’¤1.5%
  ä¿åº•ï¼šä¸ä½äºå…¥åœºä»·-2%

åšç©ºï¼š
  æ¿€æ´»æ¡ä»¶ï¼šç›ˆåˆ© >= 3%
  ç§»åŠ¨è§„åˆ™ï¼šä»æœ€ä½ä»·å›å‡1.5%
  ä¿åº•ï¼šä¸é«˜äºå…¥åœºä»·+2%
```

### 4. æ—¶é—´åŸºå‡†ï¼ˆTime-Basedï¼‰
```python
æŒä»“æ—¶é—´è¶Šé•¿ï¼Œè°ƒæ•´æ­¢æŸç­–ç•¥ï¼š
  çŸ­æœŸæŒä»“ï¼šä½¿ç”¨è¾ƒç´§æ­¢æŸ
  é•¿æœŸæŒä»“ï¼šä½¿ç”¨è¾ƒå®½æ­¢æŸ
```

### 5. æ”¯æ’‘é˜»åŠ›ä½ï¼ˆSupport/Resistanceï¼‰
```python
åšå¤šï¼š
  æ­¢æŸï¼šæ”¯æ’‘ä½ä¸‹æ–¹1%
  æ­¢ç›ˆï¼šé˜»åŠ›ä½ä¸‹æ–¹1%

åšç©ºï¼š
  æ­¢æŸï¼šé˜»åŠ›ä½ä¸Šæ–¹1%
  æ­¢ç›ˆï¼šæ”¯æ’‘ä½ä¸Šæ–¹1%
```

### 6. ç½®ä¿¡åº¦è°ƒæ•´ï¼ˆConfidence-Basedï¼‰
```python
é«˜ç½®ä¿¡åº¦ï¼ˆ>0.8ï¼‰ï¼šæ›´ç´§æ­¢æŸï¼ˆ0.7å€ï¼‰
ä¸­ç­‰ç½®ä¿¡åº¦ï¼ˆ0.6-0.8ï¼‰ï¼šæ ‡å‡†æ­¢æŸï¼ˆ1.0å€ï¼‰
ä½ç½®ä¿¡åº¦ï¼ˆ<0.6ï¼‰ï¼šæ›´å®½æ­¢æŸï¼ˆ1.3å€ï¼‰
```

## ğŸ”„ å†³ç­–æµç¨‹

### é˜¶æ®µ1ï¼šå›¢é˜Ÿåˆ†æ
```
å¹¶è¡Œæ‰§è¡Œ â†’ æŠ€æœ¯åˆ†æå¸ˆ(DeepSeek)
         â”œâ”€ æŠ€æœ¯åˆ†æå¸ˆ(åƒé—®3)
         â”œâ”€ æƒ…ç»ªåˆ†æå¸ˆ(DeepSeek)
         â”œâ”€ åŸºæœ¬é¢åˆ†æå¸ˆ(DeepSeek)
         â”œâ”€ æ–°é—»åˆ†æå¸ˆ(DeepSeek)
         â””â”€ é£é™©ç®¡ç†ç»ç†(DeepSeek) âš ï¸ å…·æœ‰å¦å†³æƒ
```

### é˜¶æ®µ2ï¼šæ„è§æ”¶é›†
```python
ä»æ¯ä¸ªAIåˆ†æä¸­æå–æ­¢ç›ˆæ­¢æŸæ„è§ï¼š
- å»ºè®®æ“ä½œï¼ˆhold/stop_loss/take_profit/trailing_stopç­‰ï¼‰
- ç½®ä¿¡åº¦ï¼ˆ0-1ï¼‰
- ç´§æ€¥ç¨‹åº¦ï¼ˆ0-1ï¼‰
- é£é™©è¯„ä¼°ï¼ˆ0-1ï¼‰
- è¯¦ç»†ç†ç”±
```

### é˜¶æ®µ3ï¼šæŠ•èµ„ç»„åˆç»ç†ç»¼åˆå†³ç­–
```python
å†³ç­–è§„åˆ™ï¼ˆæŒ‰ä¼˜å…ˆçº§ï¼‰ï¼š

1. é£é™©ç®¡ç†ç»ç†å¦å†³æƒ
   if é£é™©ç»ç†ç´§æ€¥åº¦ > 0.7:
       â†’ å¼ºåˆ¶æ‰§è¡Œé£é™©ç»ç†å»ºè®®

2. è‡ªåŠ¨è§¦å‘æ¡ä»¶ï¼ˆå…­ç§æ–¹å¼ï¼‰
   - æ£€æŸ¥å›ºå®šæ­¢æŸæ­¢ç›ˆ
   - æ£€æŸ¥ç§»åŠ¨æ­¢æŸ
   - æ£€æŸ¥æ”¯æ’‘é˜»åŠ›ä½

3. å›¢é˜Ÿå…±è¯†
   if æŸæ“ä½œå¾—ç¥¨ >= 50%:
       if å¹³å‡ç½®ä¿¡åº¦ > 0.6 and å¹³å‡ç´§æ€¥åº¦ > 0.5:
           â†’ æ‰§è¡Œè¯¥æ“ä½œ
       else:
           â†’ ç»§ç»­è§‚å¯Ÿ

4. é»˜è®¤è¡Œä¸º
   â†’ ç»§ç»­æŒä»“
```

## ğŸ’» ä½¿ç”¨ç¤ºä¾‹

### ç¤ºä¾‹1ï¼šæ³¨å†ŒæŒä»“å¹¶å¼€å§‹ç›‘æ§
```python
from backend.agents.agent_team import agent_team
from backend.agents.stop_loss_decision_system import stop_decision_system

# æ³¨å†ŒæŒä»“
position_id = "BTCUSDT_20251024_001"
stop_decision_system.register_position(
    position_id=position_id,
    symbol="BTCUSDT",
    action="buy",
    entry_price=50000.0,
    quantity=0.1,
    stop_loss=49000.0,  # -2%
    take_profit=52000.0,  # +4%
    confidence=0.75,
    strategy_info={"type": "æŠ€æœ¯çªç ´"}
)
```

### ç¤ºä¾‹2ï¼šå®šæœŸè¯„ä¼°æ­¢ç›ˆæ­¢æŸ
```python
# æ›´æ–°ä»·æ ¼
current_price = 51500.0
stop_decision_system.update_position_price(position_id, current_price)

# è·å–å¸‚åœºæ•°æ®
market_data = {
    'price': current_price,
    'change_24h': 3.0,
    'high_24h': 51800.0,
    'low_24h': 49500.0,
    'volume_24h': 1000000000
}

# å‡†å¤‡æŒä»“ä¿¡æ¯
position_info = stop_decision_system.get_position_status(position_id)
position_info['portfolio'] = portfolio_data

# AIå›¢é˜Ÿè¯„ä¼°
decision = await agent_team.evaluate_stop_loss_decision(
    position_id=position_id,
    symbol="BTCUSDT",
    market_data=market_data,
    position_info=position_info
)

# æŸ¥çœ‹å†³ç­–ç»“æœ
print(f"æœ€ç»ˆå†³ç­–: {decision['final_decision']}")  # 'execute' æˆ– 'hold'
print(f"å»ºè®®æ“ä½œ: {decision['action']}")  # stop_loss/take_profit/trailing_stopç­‰
print(f"ç½®ä¿¡åº¦: {decision['confidence']:.2f}")
print(f"ç´§æ€¥åº¦: {decision['urgency']:.2f}")
print(f"å†³ç­–ç†ç”±: {decision['reasoning']}")
print(f"å›¢é˜ŸæŠ•ç¥¨: {decision['team_votes']}")
```

### ç¤ºä¾‹3ï¼šæ‰§è¡Œå†³ç­–
```python
if decision['final_decision'] == 'execute':
    action_type = decision['action']
    
    if action_type in ['stop_loss', 'take_profit', 'trailing_stop']:
        # æ‰§è¡Œå¹³ä»“
        await trading_engine.close_position(
            symbol="BTCUSDT",
            reason=decision['reasoning']
        )
        
        # ç§»é™¤æŒä»“ç›‘æ§
        stop_decision_system.remove_position(position_id)
        
        logger.info(f"âœ… å·²æ‰§è¡Œ{action_type}: {decision['reasoning']}")
    
    elif action_type == 'tighten_stop':
        # æ”¶ç´§æ­¢æŸ
        new_stop_loss = decision['suggested_stop_loss']
        # æ›´æ–°æ­¢æŸä½...
        
        logger.info(f"ğŸ”§ å·²æ”¶ç´§æ­¢æŸåˆ°${new_stop_loss:.2f}")
```

## ğŸ“Š å†³ç­–è¾“å‡ºç¤ºä¾‹

### åœºæ™¯1ï¼šæŠ€æœ¯é¢å»ºè®®æ”¶ç´§æ­¢æŸ
```json
{
  "final_decision": "execute",
  "action": "tighten_stop",
  "confidence": 0.72,
  "urgency": 0.6,
  "reasoning": "ç›ˆåˆ©3.5%ï¼ŒæŠ€æœ¯é¢å»ºè®®æ”¶ç´§æ­¢æŸä¿æŠ¤åˆ©æ¶¦ | å›¢é˜ŸæŠ•ç¥¨: tighten_stop(3ç¥¨), hold(2ç¥¨)",
  "team_votes": {
    "tighten_stop": 3,
    "hold": 2
  },
  "position_pnl": 150.0,
  "position_pnl_pct": 3.5
}
```

### åœºæ™¯2ï¼šé£é™©ç®¡ç†ç»ç†å¼ºåˆ¶æ­¢æŸ
```json
{
  "final_decision": "execute",
  "action": "stop_loss",
  "confidence": 0.85,
  "urgency": 0.9,
  "reasoning": "ğŸ›¡ï¸ é£é™©ç®¡ç†ç»ç†å¼ºçƒˆå»ºè®®stop_loss: é£é™©è¿‡é«˜(0.75)ï¼ŒäºæŸ-2.3%ï¼Œå»ºè®®æ­¢æŸ",
  "team_votes": {
    "stop_loss": 4,
    "hold": 1
  },
  "position_pnl": -115.0,
  "position_pnl_pct": -2.3
}
```

### åœºæ™¯3ï¼šç§»åŠ¨æ­¢æŸè§¦å‘
```json
{
  "final_decision": "execute",
  "action": "trailing_stop",
  "confidence": 0.68,
  "urgency": 0.7,
  "reasoning": "ğŸ“ ç§»åŠ¨æ­¢æŸè§¦å‘: $51200.00 <= $51350.50 | å›¢é˜ŸæŠ•ç¥¨: trailing_stop(2ç¥¨), take_profit(2ç¥¨), hold(1ç¥¨)",
  "team_votes": {
    "trailing_stop": 2,
    "take_profit": 2,
    "hold": 1
  },
  "position_pnl": 1200.0,
  "position_pnl_pct": 2.4
}
```

### åœºæ™¯4ï¼šç»§ç»­æŒä»“
```json
{
  "final_decision": "hold",
  "action": "hold",
  "confidence": 0.65,
  "urgency": 0.4,
  "reasoning": "ç»§ç»­æŒä»“ï¼Œå›¢é˜Ÿå»ºè®®ç»§ç»­è§‚å¯Ÿ | å›¢é˜ŸæŠ•ç¥¨: hold(4ç¥¨), tighten_stop(1ç¥¨)",
  "team_votes": {
    "hold": 4,
    "tighten_stop": 1
  },
  "position_pnl": 50.0,
  "position_pnl_pct": 1.0
}
```

## ğŸ¯ æ ¸å¿ƒä¼˜åŠ¿

### 1. å¤šç»´åº¦åˆ†æ
- âœ… æŠ€æœ¯é¢ï¼šè¶‹åŠ¿ã€æŒ‡æ ‡ã€æ”¯æ’‘é˜»åŠ›
- âœ… åŸºæœ¬é¢ï¼šé•¿æœŸä»·å€¼ã€åŸºæœ¬é¢å˜åŒ–
- âœ… æƒ…ç»ªé¢ï¼šå¸‚åœºæƒ…ç»ªã€å¿ƒç†å› ç´ 
- âœ… æ–°é—»é¢ï¼šçªå‘äº‹ä»¶ã€é‡å¤§æ¶ˆæ¯
- âœ… é£é™©é¢ï¼šé£é™©æ§åˆ¶ã€èµ„é‡‘ç®¡ç†

### 2. æ™ºèƒ½å†³ç­–æœºåˆ¶
- âœ… é£é™©ç®¡ç†ç»ç†å…·æœ‰å¦å†³æƒ
- âœ… å›¢é˜Ÿå…±è¯†æœºåˆ¶ï¼ˆ>50%æ”¯æŒï¼‰
- âœ… è‡ªåŠ¨è§¦å‘æ¡ä»¶ï¼ˆå…­ç§æ–¹å¼ï¼‰
- âœ… å¤šçº§ç´§æ€¥åº¦è¯„ä¼°

### 3. åŠ¨æ€é€‚åº”èƒ½åŠ›
- âœ… æ ¹æ®ç½®ä¿¡åº¦è°ƒæ•´æ­¢æŸå¹…åº¦
- âœ… æ ¹æ®æ³¢åŠ¨ç‡è°ƒæ•´æ­¢æŸå¹…åº¦
- âœ… æ ¹æ®ä»“ä½å¤§å°è°ƒæ•´æ­¢æŸå¹…åº¦
- âœ… ç›ˆåˆ©åè‡ªåŠ¨å¯ç”¨ç§»åŠ¨æ­¢æŸ

### 4. é€æ˜å¯è¿½æº¯
- âœ… è¯¦ç»†çš„å†³ç­–ç†ç”±
- âœ… å®Œæ•´çš„å›¢é˜ŸæŠ•ç¥¨è®°å½•
- âœ… æ˜ç¡®çš„ç´§æ€¥åº¦å’Œç½®ä¿¡åº¦
- âœ… å¯å®¡è®¡çš„å†³ç­–è¿‡ç¨‹

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **é£é™©ç®¡ç†ç»ç†çš„å¦å†³æƒæœ€é«˜**
   - å½“é£é™©è¯„åˆ†>0.7æ—¶ï¼Œå…¶å»ºè®®å°†è¢«å¼ºåˆ¶æ‰§è¡Œ
   - ç¡®ä¿é£é™©æ§åˆ¶å§‹ç»ˆæ˜¯ç¬¬ä¸€ä¼˜å…ˆçº§

2. **å›¢é˜Ÿå…±è¯†é—¨æ§›**
   - éœ€è¦>50%çš„AIæˆå‘˜æ”¯æŒ
   - åŒæ—¶è¦æ±‚ç½®ä¿¡åº¦>0.6ä¸”ç´§æ€¥åº¦>0.5

3. **è‡ªåŠ¨è§¦å‘ä¼˜å…ˆçº§æœ€é«˜**
   - å›ºå®šæ­¢æŸæ­¢ç›ˆä¸€æ—¦è§¦å‘ç«‹å³æ‰§è¡Œ
   - ç§»åŠ¨æ­¢æŸä¼˜å…ˆäºå›¢é˜Ÿå»ºè®®

4. **å®šæœŸè¯„ä¼°é¢‘ç‡**
   - å»ºè®®æ¯1-5åˆ†é’Ÿè¯„ä¼°ä¸€æ¬¡ï¼ˆæ ¹æ®å¸‚åœºæ³¢åŠ¨ï¼‰
   - é«˜æ³¢åŠ¨å¸‚åœºåº”æ›´é¢‘ç¹è¯„ä¼°

## ğŸš€ é›†æˆåˆ°äº¤æ˜“å¼•æ“

åœ¨ `trading_engine.py` ä¸­é›†æˆï¼š

```python
from backend.agents.agent_team import agent_team
from backend.agents.stop_loss_decision_system import stop_decision_system

async def monitor_positions_stop_loss(self, db: AsyncSession):
    """ç›‘æ§æ‰€æœ‰æŒä»“çš„æ­¢ç›ˆæ­¢æŸ"""
    positions = await self._get_current_positions(db)
    
    for position in positions:
        # è·å–å¸‚åœºæ•°æ®
        ticker = await aster_client.get_ticker(position['symbol'])
        market_data = {...}
        
        # æ›´æ–°æŒä»“ä»·æ ¼
        position_id = f"{position['symbol']}_{position['id']}"
        stop_decision_system.update_position_price(
            position_id, market_data['price']
        )
        
        # AIå›¢é˜Ÿè¯„ä¼°
        decision = await agent_team.evaluate_stop_loss_decision(
            position_id=position_id,
            symbol=position['symbol'],
            market_data=market_data,
            position_info={...}
        )
        
        # æ‰§è¡Œå†³ç­–
        if decision['final_decision'] == 'execute':
            await self._execute_stop_loss_action(position, decision)
```

## ğŸ“ˆ æ•ˆæœé¢„æœŸ

- âœ… æ›´å…¨é¢çš„æ­¢ç›ˆæ­¢æŸå†³ç­–
- âœ… å‡å°‘æƒ…ç»ªåŒ–æ“ä½œ
- âœ… æé«˜é£é™©æ§åˆ¶èƒ½åŠ›
- âœ… å¢åŠ å†³ç­–é€æ˜åº¦
- âœ… ä¼˜åŒ–èµ„é‡‘ç®¡ç†æ•ˆç‡

---

**åˆ›å»ºæ—¶é—´**: 2025-10-24  
**ç³»ç»Ÿç‰ˆæœ¬**: v2.0  
**é›†æˆçŠ¶æ€**: âœ… å·²å®Œæˆ

